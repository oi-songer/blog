---
title:Wannafly Camp Day 5
tags:
---

# Wannafly Camp Day 5

> 今天的内容是一些计数相关的知识。

<!--more-->

## 课上内容

### 期望

重要的公式：

$$ E_{X+Y} = E_X + E_Y $$

$X$和$Y$之间可以是任意关系，没有任何限制。

#### 例：随机游走

##### 完全图
$$
\begin{align}
& \text{从一个点走到任意一个特定点的概率都为} \frac{1}{n-1} \\
& \text{那么期望时间便为} n-1
\end{align}
$$

##### 链
$$
\begin{align}
& E(X)=E\left( \sum_{i=1}^{n-1} X_i\right) \\
& \ \ \ \ \ \  \ \ \ \   =\sum_{i=1}^{n-1}E\left(X_i\right) \\
& X_i \text{表示从第一次进入}i\text{到第一次进入}i+1\text{的步数} \\
& X_1 = 1 \\
& X_i = \frac{1}{2} + \frac{1}{2} \times ( 1 + X_{i-1} + X_i ) \\
& \text{解，得：} X_{i+1} = X_i + 2
\end{align}
$$

#### 例：硬币游戏

我们使用$X_{i,j}$表示第$i$个硬币和第$j$个是否碰到一起。是为$1$，否则为$0$。所以：

$$ E(X) = E\left(\sum_{i<j} X_{i,j} \cdot W_i W_j \right) $$

$$ E(X_{i,j}) = \frac{2}{(j-i+1)(j-i)} $$

## 习题及解析

题目来源：[_comet OJ_](https://zhixincode.com/contest/26/problems)

### A 迷宫

设$f[i]$为有几个点的深度$\geq i$，答案即为$ \max (depth[x] + f(depth[x]) - 1) $。

### B 重新定义字典序



### C 斐波那契数列

因为$f[n] \& (f[n]-1) = f[n] - lowbit(f[n])$，而只有当$n$是$3$的倍数时，$f[n]$才是偶数。

所以，当$n=3k$时，若$k$是奇数，则$lowbit(f[n])=2$，否则$lowbit(f[n]) = lowbit(4k)$。

最后矩阵乘法求一下$f[n]$的前缀和即可。

### D 二次函数

大讨论题。

对二次函数进行平移，使得$0 \leq a \leq 1$。然后分类讨论：
1. $a$全是$0$:
	1. 存在$b_1$,$b_2$:
		$$ x_1^2 - x_2^2 = b_1 - b_2 $$
    2. 不存在$b_1$,$b_2$;
2. 存在两个$a$，一个是$0$，一个是$1$;
3. $a$全是$1$.

### E 线性探查法

考虑$b[i]$，设$b[i] \mod n = x$，则$b[n...i-1]$都要在$b[i]$之前被插入。

用**线段树优化**拓扑排序的建图，然后用优先队列求最小拓扑序即可。

### F 逆序对！

### G 抢红包机器人

暴力。

### H 同构

取补图，每个点度数变成$2$，于是图就是若干个大于等于$3$个环构成的，答案相当于$n$的证书划分。

可以用一个$n^{\frac{3}{2}}$的DP过掉。使用$f[i][j]$表示选了$i$个数，和为$j$的方案数。

### I 集合

假设$T$分成了$A+B$，设$A$，$B$的生成函数分别为$a(x)$，$b(x)$。

那么:
$$
\begin{align}
& f(A) + f(B) \\
& = a^3(x) b^3(x) \\
& = (a(x) + b(x)) (a^2(x) - a(x)b(x) + b^2(x)) \\
\\
\end{align}
$$


$a(x)+b(x)$是全集，对于右边多项式的任意⼀一个系数，$a(x)+b(x)$只存在⼀一个 $x^i$和他乘起来后是$n$的倍数。所以$F(A) + f(B) = |A|^2 - |A|(n-|A|) + (n-|A|)^2 $。

### J 强壮的排列

我们设答案为$f(n)$。考虑最大的数的位置是$i$，则变成了一个长度为$i-1$的数列和一个长度为$n-i$的数列。那么$f(n) = \frac {\sum f(i) \cdot f(n-i-1)}{n} $，所以$f'(x) = f^2(x) + 1 $,因此：

$$ f(x) = \tan x $$