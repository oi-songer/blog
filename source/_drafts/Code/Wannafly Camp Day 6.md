---
title:Wannafly Camp Day 6
tags:
---

# Wannafly Camp Day 6

> 今天是图论专题。

<!--more-->

## 课上内容

### 最短路

* 边权都为$0/1$时可以使用bfs来计算单源最短路，时间复杂度为$O(m)$。

#### Johnson算法：多源最短路

1. 有负权时，建虚拟源点，向每个点连`0`边，跑Bellman-Ford，得到最短路数组`h[]`；
2. 将每条边$w(u, v)$加上$h(u) – h(v)$；
3.  移除虚拟源点，跑堆优化Dijkstra；
4.  时间复杂度为$O(nm + km \log n)$，其中k为源点数量。

##### 应用：无向正权图的半径/直径

* $u$的偏心距： $ecc(u) = \max dist(u,v)$
* 直径：$d = max ecc(u)$
* 半径：$r = min ecc(u) (d \neq 2r)$
* 中心：$arg min ecc(u)$

### 生成树、连通分量

#### 最小瓶颈生成树
* 线性第k大数思想 
* 首先随机一个边权w
* 然后将不超过这个边权的边加入，遍历这张图
* 如果图连通，那么瓶颈不超过w，于是只需考虑边权不超过w的边
* 否则将这些连通点缩起来，考虑边权大于w的边
* $T(m) = C \cdot m + \frac{1}{m} \left( \sum_{i=1}^x T(m-x) + \sum_{i=x+1}^m T(i) \right) \leq 4C \cdot m$
* 期望时间复杂度$O(m)$

#### 最小树形图：朱刘算法

#### KAHN算法

### 二分图、匹配和覆盖

## 习题及解析

题目来源：[_comet OJ_](https://zhixincode.com/contest/30/problems)

### A Aquours

### B 玖凛两开花

二分$0$的位置，然后`check()`前面是否都能取到即可。

在`check()`时，加入我们认为`0`的位置是$i$，那么$i$前面肯定都为`1`，所以他们之间肯定都没有连边。那么我们便可以把这个图当成一个二分图，直接解二分图的最大匹配即可。

### C 御坂妹妹

### D 吉良吉影的奇妙计划

### E Souls-like Game

### F 地球上最漫长的一天

### G 穗乃果的考试

### H 二人的白皇

### I 岸边露伴的人生经验

### J 去音乐会