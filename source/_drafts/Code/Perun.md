---
title:Perun
tags:
---

# Perun, Ult!

<!--more-->

题目来源：[_Codeforces_](http://codeforces.com/contest/912/problem/C)

题解参考:[_Codeforeces Editorial_](http://codeforces.com/blog/entry/56920)

### 题意
因为题目较长，所以我们在这里先总结一下题意：在这个游戏中，有`n`个怪物，每个怪物有三个属性:`start_health`(初始血量),`max_health`(最高血量),`regen`(每秒回血数量)。然后怪物会有`m`次血量变化(血量降低)，分别由三个属性:`time`(变化的时时间),`enemy`(发生变化的敌人),`health`(降低的血量)。然后，我们开始有三个属性:`bounty`,`increase`,`damage`(伤害)。我们可以在第`t`秒来使出技能，使出技能时若`damage`大于某一怪物的血量则可杀死它，求`t`使得 $ f(t) = (t*increase + bounty)*u $最大(`u`为第`t`秒能杀死怪的数量)。

### 题解
这道题目本身没有涉及到复杂的算法，但是实现较为复杂。

对于每一秒的敌人有以下四种情况:
1. 正在增加血量并可以被杀死
2. 正在增加血量并不能被杀死
3. 已到达血量极限并不能被杀死
4. 已到达血量极限并能够被杀死

#### 特殊情况判断
其中，当且仅当第四种情况出现时，答案可以取 $ \infty $。
所以我们在进行其他运算前可以做一次预处理，若存在`max_health`小于`damage`，则输出`-1`。


#### 初步计算
我们可以提前算出每个怪物达到状态2或状态3的时间(我们设其为`End`)，然后对每一个这样的点做一次$f(t)$的运算，最后取最大的一个。

所以，我们需要计算一个怪物的`End`，常规的公式如下:
$$ End = (damage - start_health)/regen $$
注意，这里的`End`为某个怪物最后可以被杀死的时间。

但计算时我们需要注意,若该怪物`start_health`大于`damage`，因为cpp语言问题，该式子在小于0时不会舍小数，而是加一，故须手动减一(或者直接赋值-1)。

#### 血量变化时的运算
然后，我们还需要处理`m`次血量变化。
直接使用公式：
$$ End = time + (damage -  health)/regen $$
该情况时要注意`damage`小于`health`的情况。

#### 最终计算
最后，对每个怪物按`End`排序，然后计算
$$ f(x) = (n-i+1)*(bounty + increase*End) $$

最后取最大值即可。

### 代码

```C++	
```